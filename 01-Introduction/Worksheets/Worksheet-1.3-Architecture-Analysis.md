# Worksheet 1.3: ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Architecture
## ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á ESP-NOW

### üéØ ‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå
- ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á ESP-NOW ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∂‡∏Å‡∏ã‡∏∂‡πâ‡∏á
- ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Protocol Stack ‡πÅ‡∏•‡∏∞ Data Flow
- ‡∏®‡∏∂‡∏Å‡∏©‡∏≤ Hardware ‡πÅ‡∏•‡∏∞ Software Architecture
- ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞ Limitations

### üõ†Ô∏è ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ
- ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô Network Protocol Stack
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à Hardware Architecture
- ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Wireless Communication
- ESP-IDF Framework ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: Protocol Stack Analysis

### 1.1 OSI Model Mapping

ESP-NOW ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÉ‡∏î‡∏Ç‡∏≠‡∏á OSI Model? ‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ:

| OSI Layer | Layer Name | ESP-NOW Component | ‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà |
|-----------|------------|-------------------|---------|
| Layer 7 | Application | _________________ | _______ |
| Layer 6 | Presentation | _________________ | _______ |
| Layer 5 | Session | _________________ | _______ |
| Layer 4 | Transport | _________________ | _______ |
| Layer 3 | Network | _________________ | _______ |
| Layer 2 | Data Link | _________________ | _______ |
| Layer 1 | Physical | _________________ | _______ |

### 1.2 ESP-NOW Protocol Stack

‡∏ß‡∏≤‡∏î‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏° Protocol Stack ‡∏Ç‡∏≠‡∏á ESP-NOW:

```
[Application Layer]
    ‚Üï
[________________]
    ‚Üï  
[________________]
    ‚Üï
[________________]
    ‚Üï
[802.11 MAC Layer]
    ‚Üï
[802.11 PHY Layer]
```

**‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:**
1. **ESP-NOW ‡πÉ‡∏ä‡πâ IEEE 802.11 ‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡∏ö‡πâ‡∏≤‡∏á?**
   ___________________________________________________

2. **‡∏ó‡∏≥‡πÑ‡∏° ESP-NOW ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ TCP/IP Stack?**
   ___________________________________________________

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: Hardware Architecture Analysis

### 2.1 ESP32 Block Diagram

‡∏ß‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ ESP32 components ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö ESP-NOW:

```
[CPU Cores]  ‚îÄ‚îÄ‚îê
               ‚îÇ
[WiFi Radio] ‚îÄ‚îÄ‚îº‚îÄ‚îÄ [Memory] ‚îÄ‚îÄ [Peripherals]
               ‚îÇ
[Bluetooth]  ‚îÄ‚îÄ‚îò
```

**‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:**
- CPU Cores: ________________________________________
- WiFi Radio: _______________________________________
- Memory: __________________________________________
- Peripherals: ______________________________________

### 2.2 RF (Radio Frequency) Path Analysis

ESP-NOW ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡πÉ‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£?

1. **Frequency Band:** ______________________________
2. **Channel Range:** _______________________________  
3. **Channel Width:** _______________________________
4. **Modulation:** __________________________________

**‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î:** ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Channel ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ:
- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: Channel 1 (2412 MHz)
- ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î: Channel 13 (2472 MHz)  
- Channel spacing: 5 MHz
- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Channel: _______________________________

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: Software Architecture Deep Dive

### 3.1 ESP-IDF Framework Integration

‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà ESP-NOW ‡∏£‡∏ß‡∏°‡∏ï‡∏±‡∏ß‡∏Å‡∏±‡∏ö ESP-IDF:

```
Application Code
      ‚Üì
ESP-NOW API
      ‚Üì
[_______________]
      ‚Üì
[_______________]  
      ‚Üì
Hardware Abstraction Layer (HAL)
      ‚Üì
ESP32 Hardware
```

‡∏Å‡∏£‡∏≠‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î ‡πÅ‡∏•‡∏∞‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô:

1. **ESP-NOW API:** ________________________________
2. **‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 3:** ____________________________________
3. **‡∏ä‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà 4:** ____________________________________
4. **HAL:** ________________________________________

### 3.2 Memory Architecture

ESP-NOW ‡πÉ‡∏ä‡πâ Memory ‡∏Ç‡∏≠‡∏á ESP32 ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?

**Memory Types ‡πÉ‡∏ô ESP32:**

| Memory Type | Size | ESP-NOW Usage | Purpose |
|-------------|------|---------------|---------|
| SRAM | 520 KB | _____________ | _______ |
| Flash | 4 MB+ | _____________ | _______ |
| RTC Memory | 8 KB | _____________ | _______ |
| Cache | 32 KB | _____________ | _______ |

**‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:**
1. **Peer information ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô Memory ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÉ‡∏î?**
   ___________________________________________________

2. **Incoming messages buffer ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô?**
   ___________________________________________________

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 4: Data Structure Analysis

### 4.1 Peer Information Structure

‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå `esp_now_peer_info_t` structure:

```c
typedef struct {
    uint8_t peer_addr[6];    // MAC address
    uint8_t lmk[16];         // Local master key
    uint8_t channel;         // WiFi channel  
    wifi_interface_t ifidx;  // WiFi interface
    bool encrypt;            // Encryption flag
} esp_now_peer_info_t;
```

**‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå:**
1. **‡∏ó‡∏≥‡πÑ‡∏° MAC address ‡πÉ‡∏ä‡πâ 6 bytes?**
   ___________________________________________________

2. **Local master key (lmk) ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏∞‡πÑ‡∏£?**
   ___________________________________________________

3. **Channel field ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?**
   ___________________________________________________

4. **wifi_interface_t ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?**
   ___________________________________________________

### 4.2 Message Header Analysis

ESP-NOW message ‡∏°‡∏µ header ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå:

```
[ESP-NOW Message Format]
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 ‚îÇ                 ‚îÇ                 ‚îÇ
‚îÇ                 ‚îÇ                 ‚îÇ                 ‚îÇ  
‚îÇ                 ‚îÇ                 ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

‡∏Å‡∏£‡∏≠‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á ESP-NOW message:
1. **‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1:** ___________________________________
2. **‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2:** ___________________________________
3. **‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3:** ___________________________________

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 5: Timing ‡πÅ‡∏•‡∏∞ Performance Analysis

### 5.1 Transmission Timing

‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ESP-NOW:

```
[Timeline Analysis]
t0: Application calls esp_now_send()
    ‚Üì (Processing Time: ___ ms)
t1: Data reaches WiFi layer  
    ‚Üì (Transmission Time: ___ ms)
t2: Data transmitted over air
    ‚Üì (Processing Time: ___ ms) 
t3: Receiver gets data
    ‚Üì (Callback Time: ___ ms)
t4: Application processes data

Total Latency: _______ ms
```

**‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:**
1. **‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î?**
   ___________________________________________________

2. **‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡∏î Latency:**
   ___________________________________________________

### 5.2 Throughput Calculation

**‡πÇ‡∏à‡∏ó‡∏¢‡πå:** ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Maximum Throughput ‡∏Ç‡∏≠‡∏á ESP-NOW

‡∏Å‡∏≥‡∏´‡∏ô‡∏î:
- Maximum packet size: 250 bytes
- Minimum interval between packets: 1 ms
- Protocol overhead: 10%

**‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì:**
1. **Effective data per packet:** ___________________
2. **Packets per second:** __________________________  
3. **Maximum throughput:** __________________________
4. **‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö WiFi 802.11n:** __________________

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 6: Security Architecture

### 6.1 Encryption Mechanism

ESP-NOW ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?

```
[Encryption Process]
Plaintext Data
      ‚Üì
[________________]
      ‚Üì
[________________]
      ‚Üì  
Encrypted Data
      ‚Üì
Transmission
```

‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™:
1. **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1:** ________________________________
2. **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2:** ________________________________

**‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:**
1. **ESP-NOW ‡πÉ‡∏ä‡πâ Encryption algorithm ‡∏≠‡∏∞‡πÑ‡∏£?**
   ___________________________________________________

2. **Key management ‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?**
   ___________________________________________________

3. **‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡πà‡∏≠ Performance ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?**
   ___________________________________________________

### 6.2 Security Limitations

‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏î‡πâ‡∏≤‡∏ô Security ‡∏Ç‡∏≠‡∏á ESP-NOW:

| Security Aspect | ESP-NOW Support | Limitation | Impact |
|-----------------|-----------------|------------|--------|
| Authentication | ______________ | __________ | ______ |
| Authorization | ______________ | __________ | ______ |
| Data Integrity | ______________ | __________ | ______ |
| Replay Protection | ______________ | __________ | ______ |
| Forward Secrecy | ______________ | __________ | ______ |

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 7: Error Handling Architecture

### 7.1 Error Types ‡πÅ‡∏•‡∏∞ Handling

ESP-NOW ‡∏°‡∏µ Error handling mechanism ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?

**Error Categories:**
1. **Transmission Errors:**
   - ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: _____________________________________
   - ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£: __________________________________

2. **Configuration Errors:**  
   - ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: _____________________________________
   - ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£: __________________________________

3. **Resource Errors:**
   - ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: _____________________________________
   - ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£: __________________________________

### 7.2 Callback Architecture

‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Callback system ‡∏Ç‡∏≠‡∏á ESP-NOW:

```c
// Send callback
void on_data_sent(const uint8_t *mac_addr, esp_now_send_status_t status);

// Receive callback  
void on_data_recv(const uint8_t *mac_addr, const uint8_t *data, int len);
```

**‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:**
1. **Callback functions ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô context ‡πÉ‡∏î?**
   ___________________________________________________

2. **‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÉ‡∏ô callback:**
   ___________________________________________________

3. **‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û callback:**
   ___________________________________________________

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 8: Scalability Analysis

### 8.1 Peer Limitation Impact

ESP-NOW ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 20 peers maximum ‡∏°‡∏µ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå:** Smart Home ‡∏Å‡∏±‡∏ö 50 ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå

```
[Network Architecture Design]

Central Hub
    ‚Üì
[________________]
    ‚Üì
[________________]
    ‚Üì
End Devices (50 units)
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤:**
1. **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1:** ___________________________________
2. **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2:** ___________________________________  
3. **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 3:** ___________________________________

### 8.2 Multi-hop Communication

ESP-NOW ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Multi-hop ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?

**‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå:**
1. **Native multi-hop support:**
   ___________________________________________________

2. **‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á multi-hop manually:**
   ___________________________________________________

3. **‡∏Ç‡πâ‡∏≠‡∏î‡∏µ-‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏Ç‡∏≠‡∏á multi-hop:**
   ___________________________________________________

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 9: Power Management Architecture

### 9.1 Power States

ESP32 ‡∏°‡∏µ Power states ‡πÉ‡∏î‡∏ö‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö ESP-NOW?

| Power State | Current Draw | ESP-NOW Capability | Wake-up Time |
|-------------|--------------|-------------------|--------------|
| Active | ____________ | _________________ | ____________ |
| Light Sleep | ____________ | _________________ | ____________ |
| Deep Sleep | ____________ | _________________ | ____________ |

### 9.2 Battery Life Calculation

**‡πÇ‡∏à‡∏ó‡∏¢‡πå:** Battery-powered sensor node
- Active time: 100ms (send data)
- Deep sleep: 60 seconds
- Battery: 2000 mAh
- Active current: 100 mA
- Deep sleep current: 10 ŒºA

**‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì:**
1. **Duty cycle:** ___________________________________
2. **Average current:** _____________________________
3. **Battery life:** ________________________________

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 10: Real-world Implementation Challenges

### 10.1 Interference Analysis

WiFi 2.4 GHz band ‡∏°‡∏µ interference ‡∏à‡∏≤‡∏Å‡πÅ‡∏´‡∏•‡πà‡∏á‡πÉ‡∏î‡∏ö‡πâ‡∏≤‡∏á?

**Interference Sources:**
1. **WiFi Networks:** _______________________________
2. **Bluetooth Devices:** ___________________________
3. **Microwave Ovens:** _____________________________
4. **Industrial Equipment:** _________________________

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Interference:**
- _______________________________________________
- _______________________________________________
- _______________________________________________

### 10.2 Range ‡πÅ‡∏•‡∏∞ Obstacle Effects

‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Ç‡∏≠‡∏á‡∏™‡∏¥‡πà‡∏á‡∏Å‡∏µ‡∏î‡∏Ç‡∏ß‡∏≤‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£:

| Obstacle Type | Signal Loss (dB) | Range Reduction | Mitigation |
|---------------|------------------|-----------------|------------|
| Wall (Concrete) | ______________ | ______________ | __________ |
| Wall (Wood) | ______________ | ______________ | __________ |
| Metal Sheet | ______________ | ______________ | __________ |
| Water | ______________ | ______________ | __________ |

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 11: Comparative Architecture Analysis

### 11.1 ESP-NOW vs WiFi Direct

‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°:

| Architecture Aspect | ESP-NOW | WiFi Direct |
|-------------------|---------|-------------|
| Connection Setup | _______ | ___________ |
| Protocol Stack | _______ | ___________ |
| Security Layer | _______ | ___________ |
| Power Consumption | _______ | ___________ |
| Memory Usage | _______ | ___________ |

### 11.2 ESP-NOW vs Bluetooth LE

| Architecture Aspect | ESP-NOW | Bluetooth LE |
|-------------------|---------|--------------|
| Discovery Process | _______ | ____________ |
| Pairing Mechanism | _______ | ____________ |
| Data Transmission | _______ | ____________ |
| Error Recovery | _______ | ____________ |

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 12: Future Enhancement Analysis

### 12.1 Potential Improvements

‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ:

1. **Protocol Level:**
   - ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: _______________________________
   - ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ô‡∏≠: ____________________________

2. **Hardware Level:**
   - ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: _______________________________
   - ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ô‡∏≠: ____________________________

3. **Software Level:**
   - ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: _______________________________
   - ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ô‡∏≠: ____________________________

### 12.2 Integration Possibilities

ESP-NOW ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ú‡∏™‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?

1. **ESP-NOW + WiFi:**
   ___________________________________________________

2. **ESP-NOW + Bluetooth:**
   ___________________________________________________

3. **ESP-NOW + LoRa:**
   ___________________________________________________

---

## ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 13: Practical Design Exercise

### 13.1 Architecture Design Challenge

**‡πÇ‡∏à‡∏ó‡∏¢‡πå:** ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏ö Environmental Monitoring

**Requirements:**
- 100 sensor nodes (temperature, humidity, air quality)
- Coverage area: 1 km¬≤
- Data collection every 5 minutes
- Battery life: 2 years minimum
- Central monitoring station
- Real-time alerts for critical values

**‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö:**

1. **Overall System Architecture:**
   ```
   [‡∏ß‡∏≤‡∏î‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏° System Architecture]
   
   
   
   
   ```

2. **Network Topology:**
   ```
   [‡∏ß‡∏≤‡∏î‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏° Network Topology]
   
   
   
   
   ```

3. **Data Flow Design:**
   ```
   [‡∏ß‡∏≤‡∏î‡πÑ‡∏î‡∏≠‡∏∞‡πÅ‡∏Å‡∏£‡∏° Data Flow]
   
   
   
   
   ```

4. **Power Management Strategy:**
   ___________________________________________________

5. **Error Recovery Mechanism:**
   ___________________________________________________

### 13.2 Performance Estimation

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì:

1. **Total data throughput:** ________________________
2. **Network load per node:** _______________________
3. **Battery life estimation:** ______________________
4. **Maximum latency:** _____________________________
5. **System reliability:** ___________________________

---

## ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏≥ Worksheet ‡∏ô‡∏µ‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏ß‡∏£‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ:

- [ ] ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á ESP-NOW ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö
- [ ] ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Protocol Stack ‡πÅ‡∏•‡∏∞ Data Flow ‡πÑ‡∏î‡πâ
- [ ] ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÑ‡∏î‡πâ
- [ ] ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ ESP-NOW ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
- [ ] ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏•‡∏∂‡∏Å‡∏ã‡∏∂‡πâ‡∏á

### üéØ Architecture Understanding Assessment:

‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à (1-5):

- Protocol Stack: ___/5
- Hardware Architecture: ___/5
- Software Integration: ___/5
- Performance Analysis: ___/5
- Security Architecture: ___/5
- Scalability Considerations: ___/5

**Total Score: ___/30**

### üìù Key Takeaways:

‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏™‡∏£‡∏∏‡∏õ 3 ‡∏™‡∏¥‡πà‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ:

1. ___________________________________________________
2. ___________________________________________________
3. ___________________________________________________

---

**üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ö‡∏ó‡∏ó‡∏µ‡πà 1: Introduction ‡πÅ‡∏•‡πâ‡∏ß**

**‚è≠Ô∏è ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö [‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2: ESP-IDF Setup](../../02-ESP-IDF-Setup/02-ESP-IDF-Setup.md)**